<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>LED Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background: #ecf0f3;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      color: #333;
    }
    .card {
      width: 100%;
      max-width: 460px;
      background: #ecf0f3;
      border-radius: 24px;
      padding: 26px 22px;
      box-shadow: 12px 12px 24px #c9ccd1,
                  -12px -12px 24px #ffffff;
    }
    .back-btn {
      display: inline-block;
      margin-bottom: 10px;
      padding: 6px 14px;
      font-size: 13px;
      font-weight: 700;
      color: #2f5bea;
      text-decoration: none;
      border-radius: 14px;
      background: #ecf0f3;
      box-shadow: 4px 4px 8px #c9ccd1,
                  -4px -4px 8px #ffffff;
    }
    h2 { text-align: center; margin-bottom: 18px; }
    label { font-size: 13px; margin-bottom: 6px; display: block; }
    input, select {
      width: 100%;
      padding: 12px;
      margin-bottom: 14px;
      border-radius: 18px;
      border: none;
      background: #ecf0f3;
      box-shadow: inset 5px 5px 10px #c9ccd1,
                  inset -5px -5px 10px #ffffff;
      font-size: 14px;
    }
    .row { display: flex; gap: 10px; }
    .row > div { flex: 1; }

    button {
      width: 100%;
      padding: 14px;
      border-radius: 18px;
      border: none;
      background: #5b8cff;
      color: #fff;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
    }
    .result {
      margin-top: 18px;
      padding: 14px;
      border-radius: 16px;
      background: #ecf0f3;
      box-shadow: inset 4px 4px 8px #c9ccd1,
                  inset -4px -4px 8px #ffffff;
      font-size: 14px;
      line-height: 1.6;
    }
    .value { font-weight: 700; color: #2f5bea; }
    .power { font-weight: 700; color: #d93025; }

    .mode {
      display: flex;
      gap: 10px;
      margin-bottom: 14px;
    }
    .mode button {
      background: #ecf0f3;
      color: #333;
      box-shadow: 4px 4px 8px #c9ccd1,
                  -4px -4px 8px #ffffff;
    }
    .mode button.active {
      background: #5b8cff;
      color: #fff;
    }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.35);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    .modal.active { display: flex; }
    .modal-box {
      background: #ecf0f3;
      border-radius: 22px;
      padding: 22px;
      width: 90%;
      max-width: 360px;
      box-shadow: 14px 14px 28px #c9ccd1,
                  -14px -14px 28px #ffffff;
    }
    .modal-title {
      text-align: center;
      font-weight: 600;
      margin-bottom: 14px;
    }
    .modal-result {
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 16px;
    }
    .close-btn {
      width: 100%;
      padding: 12px;
      border-radius: 16px;
      border: none;
      background: #5b8cff;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="card">
  <a href="index.html" class="back-btn">‚Üê V·ªÅ trang ch·ªß</a>
  <h2>üîå LED Calculator</h2>

  <label>Ch·∫ø ƒë·ªô t√≠nh</label>
  <div class="mode">
    <button id="btnSafe" class="active" onclick="setMode('safe')">üõ° An to√†n</button>
    <button id="btnExact" onclick="setMode('exact')">üéØ Ch√≠nh x√°c</button>
  </div>

  <!-- CHI·ªÄU D√ÄI | S·ªê L∆Ø·ª¢NG -->
  <div class="row">
    <div>
      <label>Chi·ªÅu d√†i (m)</label>
      <input type="number" id="length" value="0" step="0.01">
    </div>
    <div>
      <label>S·ªë l∆∞·ª£ng ƒë√®n</label>
      <input type="number" id="qty" value="1">
    </div>
  </div>

  <!-- S·ªê ƒê∆Ø·ªúNG LED -->
  <label>S·ªë ƒë∆∞·ªùng LED</label>
  <div class="row">
    <div>
      <select id="lineSuggest" onchange="applyLine()">
        <option value="">‚Äî G·ª£i √Ω theo chi·ªÅu r·ªông ‚Äî</option>
        <option value="1">‚â§ 60mm ‚Üí 1 ƒë∆∞·ªùng</option>
        <option value="2">61‚Äì200mm ‚Üí 2 ƒë∆∞·ªùng</option>
        <option value="3">&gt; 200mm ‚Üí 3 ƒë∆∞·ªùng</option>
      </select>
    </div>
    <div>
      <input type="number" id="lines" value="1">
    </div>
  </div>

  <!-- LO·∫†I LED | C√îNG SU·∫§T -->
  <div class="row">
    <div>
      <label>Ch·ªçn Lo·∫°i LED ƒëang d√πng</label>
      <select id="ledType" onchange="applyLed()">
        <option value="">‚Äî Ch·ªçn lo·∫°i LED ‚Äî</option>
        <option value="20">2835-10MM-240D ‚Äî 20W/m</option>
        <option value="20">2835-15MM-240D ‚Äî 20W/m</option>
        <option value="28">2835-20MM-276D ‚Äî 28W/m</option>
        <option value="28">2835-30MM-280D ‚Äî 28W/m</option>
        <option value="36">2835-12MM-360D ‚Äî 36W/m</option>
        <option value="36">2835-15MM-360D ‚Äî 36W/m</option>
        <option value="36">2835-30MM-360D ‚Äî 36W/m</option>
        <option value="48">2835-15MM-480D ‚Äî 48W/m</option>
        <option value="48">2835-40MM-480D ‚Äî 48W/m</option>
        <option value="60">2835-50MM-600D ‚Äî 60W/m</option>
      </select>
    </div>
    <div>
      <label>C√¥ng su·∫•t (W/m)</label>
      <input type="number" id="powerPerM" value="28">
    </div>
  </div>

  <label>C√¥ng su·∫•t 1 ngu·ªìn (W)</label>
  <input type="number" id="psu" value="400">

  <label>C√¥ng su·∫•t ngu·ªìn s·ª≠ d·ª•ng (%)</label>
  <input type="number" id="loadPercent" value="80">

  <button onclick="calculate()">T√≠nh to√°n</button>

  <div class="result">
    <div>T·ªïng chi·ªÅu d√†i LED: <span class="value" id="rLength">‚Äì</span></div>
    <div>T·ªïng c√¥ng su·∫•t LED: <span class="value" id="rPower">‚Äì</span></div>
    <div>S·ªë ngu·ªìn <span class="power" id="rPsu">‚Äì</span>:
      <span class="value" id="rQty">‚Äì</span>
    </div>
  </div>
</div>

<div class="modal" id="resultModal">
  <div class="modal-box">
    <div class="modal-title">üìä K·∫øt qu·∫£ t√≠nh to√°n</div>
    <div class="modal-result" id="modalContent"></div>
    <button class="close-btn" onclick="closeModal()">ƒê√≥ng</button>
  </div>
</div>

<script>
let calcMode = "safe";

const lengthInput = document.getElementById("length");
const qtyInput = document.getElementById("qty");
const linesInput = document.getElementById("lines");
const powerPerMInput = document.getElementById("powerPerM");
const psuInput = document.getElementById("psu");
const loadPercentInput = document.getElementById("loadPercent");

function fmt(n) {
  return Number.isInteger(n) ? n : n.toFixed(2);
}

function setMode(m) {
  calcMode = m;
  btnSafe.classList.toggle("active", m === "safe");
  btnExact.classList.toggle("active", m === "exact");
}

function applyLed() {
  if (ledType.value) powerPerM.value = ledType.value;
}

function applyLine() {
  if (lineSuggest.value) lines.value = lineSuggest.value;
}

function calculate() {
  const length = +lengthInput.value;
  const qty = +qtyInput.value;
  const lines = +linesInput.value;
  const powerPerM = +powerPerMInput.value;
  const psu = +psuInput.value;
  const load = +loadPercentInput.value;

  let lengthPerLamp, powerPerLamp;

  if (calcMode === "safe") {
    lengthPerLamp = Math.ceil(length * lines);
    powerPerLamp  = Math.ceil(lengthPerLamp * powerPerM);
  } else {
    lengthPerLamp = length * lines;
    powerPerLamp  = lengthPerLamp * powerPerM;
  }

  const requiredPsuPowerPerLamp = powerPerLamp / (load / 100);
  const psuPerLamp = Math.ceil(requiredPsuPowerPerLamp / psu);

  const totalLength = lengthPerLamp * qty;
  const totalPower  = powerPerLamp * qty;
  const totalPsu    = psuPerLamp * qty;

  rLength.innerText = fmt(totalLength) + " m";
  rPower.innerText  = fmt(totalPower) + " W";
  rPsu.innerText    = psu + "W (" + load + "%)";
  rQty.innerText    = totalPsu + " c·ª•c";

  modalContent.innerHTML = `
    Ch·∫ø ƒë·ªô: <b>${calcMode === "safe" ? "An to√†n" : "Ch√≠nh x√°c"}</b><br>
    T·ªïng chi·ªÅu d√†i LED: <b>${fmt(totalLength)} m</b><br>
    T·ªïng c√¥ng su·∫•t LED: <b>${fmt(totalPower)} W</b><br>
    S·ªë ngu·ªìn cho 1 ƒë√®n: <b>${psuPerLamp} c·ª•c</b><br>
    T·ªïng s·ªë ngu·ªìn: <b>${totalPsu} c·ª•c</b>
  `;

  resultModal.classList.add("active");
}

function closeModal() {
  resultModal.classList.remove("active");
}
</script>

</body>
</html>
